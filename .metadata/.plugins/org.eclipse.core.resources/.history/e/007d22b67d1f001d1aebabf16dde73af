package object.clone;

import java.util.Arrays;

class Computer {
	String brand;

	Computer(String brand) {
		super();
		this.brand = brand;
	}

}//Computer 끝

/**
 * Cloneable 구현하지 않고 clone()메서드 호출하면
 * CloneNotSupportedException 예외객체 발생하여 복제 실패
 * <※Cloneable 인터페이스를 구현해야 하는 이유?>
 *  clone()메서드를 사용하면 객체의 정보(멤버변수 값)가 같은 객체가 하나 더 생성되는 것이므로
 *  객체지향프로그램의 '정보은닉', 객체 보호의 관점에서 위배될 수 있으므로
 *  객체의 clone()메서드 사용을 허용한다는 의미로 Cloneable 인터페이스를 명시해 줌
 */

//Cloneable 구현함으로써 "객체를 복제할 수 있는 클래스"라고 알림
class Student implements Cloneable { //부모 : Object
	int studentId; 		//아이디
	String studentName; //이름
	
	//private int[] scores;		//점수들
	int[] scores;		//점수들
	Computer com;		//컴퓨터
	
	Student(int studentId, String studentName, int[] scores, Computer com) {
		super();
		this.studentId = studentId;
		this.studentName = studentName;
		this.scores = scores;
		this.com = com;
	}
	
	/*
	@Override //재정의 : 얕은복제
	protected Object clone() throws CloneNotSupportedException {
		return super.clone(); //Object.clone()호출 : 얕은복제
	}
	*/

	@Override //재정의 : 깊은복제
	protected Student clone() throws CloneNotSupportedException {
		//1. 먼저 얕은복제로 객체를 통째로 복사한다.
		Student cpyStudent = (Student) super.clone(); //Object의 clone() 호출하여 얕은복제
		
		//2. '깊은복제의 대상'이 되는 객체들을 복제한다.
		cpyStudent.scores = Arrays.copyOf(this.scores, this.scores.length);//배열복제
		cpyStudent.com = new Computer(this.com.brand);					//Computer 객체 복제
		
		//3. 깊은 복제된 cpy를 리턴한다.
		return cpyStudent; 
	}
	
	Student copyStudent() {
		Student cpyStudent = null;
		
		try {
			//cpyStudent = (Student) clone(); //재정의 안할 경우 Object의 clone() 호출하여 얕은복제
			cpyStudent = clone(); //재정의 안할 경우 Object의 clone() 호출하여 얕은복제
		} catch (CloneNotSupportedException e) {
			e.printStackTrace();
		}
		
		return cpyStudent;
	}
	
	
	void showStudentInfo() {
		System.out.println("아이디 : " + studentId);
		System.out.println("이름 : " + studentName);
		System.out.println("점수 : " + Arrays.toString(scores)); //[,,]
		System.out.println("컴퓨터 브랜드 : " + com.brand);
	}
	
	
}//Student의 끝

public class StudentClone {

	public static void main(String[] args) {
		
		
		Student orgStudent = new Student(3, "이순신", new int[] {99, 93}, new Computer("LG"));
		System.out.println("[원본 학생]");
		orgStudent.showStudentInfo();
		
		System.out.println(); //구분위한 빈줄
		
		Student cpyStudent = orgStudent.copyStudent();
		System.out.println("[복제 학생]");
		cpyStudent.showStudentInfo();
		
		System.out.println("-- 복제 학생 값 변경 --");
		cpyStudent.studentId = 2;
		cpyStudent.studentName = "홍길동";
		cpyStudent.scores[0] = 0;
		cpyStudent.com.brand = "삼성";
		
		System.out.println("[복제 학생 값 변경 후 원본 학생]");
		orgStudent.showStudentInfo();
		
		System.out.println(); //구분용 빈 줄
		
		System.out.println("[복제 학생 값 변경 후 복제 학생]");
		cpyStudent.showStudentInfo();
		
		/************************************
			[원본 학생]
			아이디 : 3
			이름 : 이순신
			점수 : [99, 93]
			컴퓨터 브랜드 : LG
			
			[복제 학생]
			아이디 : 3
			이름 : 이순신
			점수 : [99, 93]
			컴퓨터 브랜드 : LG
			-- 복제 학생 값 변경 --
			[복제 학생 값 변경 후 원본 학생]
			아이디 : 3
			이름 : 이순신
			점수 : [0, 93] 	=> 원본 수정(문제발생:이유?얕은 복제) 해결법:깊은 복제
			컴퓨터 브랜드 : 삼성 => 원본 수정(문제발생:이유?얕은 복제)
			
			[복제 학생 값 변경 후 복제 학생]
			아이디 : 2
			이름 : 홍길동
			점수 : [0, 93]
			컴퓨터 브랜드 : 삼성
		 ************************************/
	}

}
